# PostgreSQL Security and Resource Limits

# Connection limits
max_connections = 50

# Memory limits (prevent OOM)
shared_buffers = 128MB
effective_cache_size = 512MB
work_mem = 4MB
maintenance_work_mem = 64MB

# Statement timeout (prevent long-running queries)
statement_timeout = 30000  # 30 seconds

# Lock timeout
lock_timeout = 10000  # 10 seconds

# Idle transaction timeout
idle_in_transaction_session_timeout = 60000  # 1 minute

# Log settings (for monitoring abuse)
log_min_duration_statement = 1000  # Log queries taking more than 1 second
log_connections = on
log_disconnections = on
log_line_prefix = '%t [%p]: user=%u,db=%d,app=%a,client=%h '

# Security settings
ssl = off  # Disabled for local use, enable for production
password_encryption = scram-sha-256

# Resource limits per connection
temp_file_limit = 1GB  # Limit temp file size per query

# Prevent excessive disk usage from logs
log_rotation_age = 1d
log_rotation_size = 100MB
log_truncate_on_rotation = on
